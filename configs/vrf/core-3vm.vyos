configure
set system host-name 'core-3vm'

### VRF configuration removed per new plan (no VRFs).

# AZ interfaces (AZ_CORE VRF)
set interfaces ethernet eth0 description 'AZ-DREN'
set interfaces ethernet eth0 address '222.222.10.2/24'
set interfaces ethernet eth0 vrf 'AZ_CORE'

set interfaces ethernet eth1 description 'AZ-SDPC'
set interfaces ethernet eth1 address '10.0.0.1/24'
set interfaces ethernet eth1 vrf 'AZ_CORE'

set interfaces ethernet eth2 description 'AZ-SDPG'
set interfaces ethernet eth2 address '10.0.1.1/24'
set interfaces ethernet eth2 vrf 'AZ_CORE'

set interfaces ethernet eth3 description 'AZ-SDPT'
set interfaces ethernet eth3 address '10.0.2.1/24'
set interfaces ethernet eth3 vrf 'AZ_CORE'

set interfaces ethernet eth4 description 'AZ-AVD'
set interfaces ethernet eth4 address '10.0.3.1/24'
set interfaces ethernet eth4 vrf 'AZ_CORE'

set interfaces ethernet eth5 description 'AZ-DOMAIN'
set interfaces ethernet eth5 address '10.1.0.1/24'
set interfaces ethernet eth5 vrf 'AZ_CORE'

set interfaces ethernet eth6 description 'AZ-DOMSVC'
set interfaces ethernet eth6 address '10.1.1.1/24'
set interfaces ethernet eth6 vrf 'AZ_CORE'

set interfaces ethernet eth7 description 'AZ-DEV'
set interfaces ethernet eth7 address '10.2.0.1/24'
set interfaces ethernet eth7 vrf 'AZ_CORE'

set interfaces ethernet eth8 description 'AZ-DEVSVC'
set interfaces ethernet eth8 address '10.2.1.1/24'
set interfaces ethernet eth8 vrf 'AZ_CORE'

# ONP interfaces (ONP_CORE VRF)
set interfaces ethernet eth9 description 'ONP-DREN'
set interfaces ethernet eth9 address '222.222.20.2/24'
set interfaces ethernet eth9 vrf 'ONP_CORE'

set interfaces ethernet eth10 description 'ONP-SDPC'
set interfaces ethernet eth10 address '20.0.0.1/24'
set interfaces ethernet eth10 vrf 'ONP_CORE'

set interfaces ethernet eth11 description 'ONP-SDPG'
set interfaces ethernet eth11 address '20.0.1.1/24'
set interfaces ethernet eth11 vrf 'ONP_CORE'

set interfaces ethernet eth12 description 'ONP-SDPT'
set interfaces ethernet eth12 address '20.0.2.1/24'
set interfaces ethernet eth12 vrf 'ONP_CORE'

set interfaces ethernet eth13 description 'ONP-AVD'
set interfaces ethernet eth13 address '20.0.3.1/24'
set interfaces ethernet eth13 vrf 'ONP_CORE'

set interfaces ethernet eth14 description 'ONP-DOMAIN'
set interfaces ethernet eth14 address '20.1.0.1/24'
set interfaces ethernet eth14 vrf 'ONP_CORE'

set interfaces ethernet eth15 description 'ONP-DOMSVC'
set interfaces ethernet eth15 address '20.1.1.1/24'
set interfaces ethernet eth15 vrf 'ONP_CORE'

set interfaces ethernet eth16 description 'ONP-DEV'
set interfaces ethernet eth16 address '20.2.0.1/24'
set interfaces ethernet eth16 vrf 'ONP_CORE'

set interfaces ethernet eth17 description 'ONP-DEVSVC'
set interfaces ethernet eth17 address '20.2.1.1/24'
set interfaces ethernet eth17 vrf 'ONP_CORE'

# Routing to EDGE
set protocols static route '0.0.0.0/0' next-hop '222.222.10.1' vrf 'AZ_CORE'
set protocols static route '20.0.0.0/8' next-hop '222.222.10.1' vrf 'AZ_CORE'

set protocols static route '0.0.0.0/0' next-hop '222.222.20.1' vrf 'ONP_CORE'
set protocols static route '10.0.0.0/8' next-hop '222.222.20.1' vrf 'ONP_CORE'

# Network groups (AZ)
set firewall group network-group AZ_LOCAL_GW network '10.0.1.0/24'
set firewall group network-group AZ_LOCAL_GW network '10.0.2.0/24'
set firewall group network-group AZ_LOCAL_SDPC network '10.0.0.0/24'
set firewall group network-group AZ_REMOTE_GW network '20.0.1.0/24'
set firewall group network-group AZ_REMOTE_GW network '20.0.2.0/24'

set firewall group network-group AZ_LOCAL_DOWNSTREAM network '10.1.0.0/24'
set firewall group network-group AZ_LOCAL_DOWNSTREAM network '10.1.1.0/24'
set firewall group network-group AZ_LOCAL_DOWNSTREAM network '10.2.0.0/24'
set firewall group network-group AZ_LOCAL_DOWNSTREAM network '10.2.1.0/24'
set firewall group network-group AZ_LOCAL_DOWNSTREAM network '10.3.0.0/24'

set firewall group network-group AZ_REMOTE_DOWNSTREAM network '20.1.0.0/24'
set firewall group network-group AZ_REMOTE_DOWNSTREAM network '20.1.1.0/24'
set firewall group network-group AZ_REMOTE_DOWNSTREAM network '20.2.0.0/24'
set firewall group network-group AZ_REMOTE_DOWNSTREAM network '20.2.1.0/24'
set firewall group network-group AZ_REMOTE_DOWNSTREAM network '20.3.0.0/24'

# Network groups (ONP)
set firewall group network-group ONP_LOCAL_GW network '20.0.1.0/24'
set firewall group network-group ONP_LOCAL_GW network '20.0.2.0/24'
set firewall group network-group ONP_LOCAL_SDPC network '20.0.0.0/24'
set firewall group network-group ONP_REMOTE_GW network '10.0.1.0/24'
set firewall group network-group ONP_REMOTE_GW network '10.0.2.0/24'

set firewall group network-group ONP_LOCAL_DOWNSTREAM network '20.1.0.0/24'
set firewall group network-group ONP_LOCAL_DOWNSTREAM network '20.1.1.0/24'
set firewall group network-group ONP_LOCAL_DOWNSTREAM network '20.2.0.0/24'
set firewall group network-group ONP_LOCAL_DOWNSTREAM network '20.2.1.0/24'
set firewall group network-group ONP_LOCAL_DOWNSTREAM network '20.3.0.0/24'

set firewall group network-group ONP_REMOTE_DOWNSTREAM network '10.1.0.0/24'
set firewall group network-group ONP_REMOTE_DOWNSTREAM network '10.1.1.0/24'
set firewall group network-group ONP_REMOTE_DOWNSTREAM network '10.2.0.0/24'
set firewall group network-group ONP_REMOTE_DOWNSTREAM network '10.2.1.0/24'
set firewall group network-group ONP_REMOTE_DOWNSTREAM network '10.3.0.0/24'

# Port groups (protected resources)
set firewall group port-group PROTECTED_TCP port '22'
set firewall group port-group PROTECTED_TCP port '80'
set firewall group port-group PROTECTED_TCP port '443'
set firewall group port-group PROTECTED_TCP port '445'
set firewall group port-group PROTECTED_TCP port '3389'
set firewall group port-group PROTECTED_TCP port '1433'
set firewall group port-group PROTECTED_TCP port '1521'
set firewall group port-group PROTECTED_TCP port '3306'
set firewall group port-group PROTECTED_TCP port '5432'
set firewall group port-group PROTECTED_TCP port '27017'
set firewall group port-group PROTECTED_UDP port '3389'

# AZ rulesets
set firewall ipv4 name AZ-SDPC-TO-GW default-action 'drop'
set firewall ipv4 name AZ-SDPC-TO-GW rule 10 action 'accept'
set firewall ipv4 name AZ-SDPC-TO-GW rule 10 state established
set firewall ipv4 name AZ-SDPC-TO-GW rule 10 state related
set firewall ipv4 name AZ-SDPC-TO-GW rule 20 action 'accept'
set firewall ipv4 name AZ-SDPC-TO-GW rule 20 state new
set firewall ipv4 name AZ-SDPC-TO-GW rule 20 protocol 'tcp'
set firewall ipv4 name AZ-SDPC-TO-GW rule 20 destination group network-group 'AZ_LOCAL_GW'
set firewall ipv4 name AZ-SDPC-TO-GW rule 20 destination port '443'
set firewall ipv4 name AZ-SDPC-TO-GW rule 30 action 'accept'
set firewall ipv4 name AZ-SDPC-TO-GW rule 30 state new
set firewall ipv4 name AZ-SDPC-TO-GW rule 30 protocol 'tcp'
set firewall ipv4 name AZ-SDPC-TO-GW rule 30 destination group network-group 'AZ_LOCAL_GW'
set firewall ipv4 name AZ-SDPC-TO-GW rule 30 destination port '444'

set firewall ipv4 name AZ-SDPC-TO-REMOTE-GW default-action 'drop'
set firewall ipv4 name AZ-SDPC-TO-REMOTE-GW rule 10 action 'accept'
set firewall ipv4 name AZ-SDPC-TO-REMOTE-GW rule 10 state established
set firewall ipv4 name AZ-SDPC-TO-REMOTE-GW rule 10 state related
set firewall ipv4 name AZ-SDPC-TO-REMOTE-GW rule 20 action 'accept'
set firewall ipv4 name AZ-SDPC-TO-REMOTE-GW rule 20 state new
set firewall ipv4 name AZ-SDPC-TO-REMOTE-GW rule 20 protocol 'tcp'
set firewall ipv4 name AZ-SDPC-TO-REMOTE-GW rule 20 destination group network-group 'AZ_REMOTE_GW'
set firewall ipv4 name AZ-SDPC-TO-REMOTE-GW rule 20 destination port '443'
set firewall ipv4 name AZ-SDPC-TO-REMOTE-GW rule 30 action 'accept'
set firewall ipv4 name AZ-SDPC-TO-REMOTE-GW rule 30 state new
set firewall ipv4 name AZ-SDPC-TO-REMOTE-GW rule 30 protocol 'tcp'
set firewall ipv4 name AZ-SDPC-TO-REMOTE-GW rule 30 destination group network-group 'AZ_REMOTE_GW'
set firewall ipv4 name AZ-SDPC-TO-REMOTE-GW rule 30 destination port '444'

set firewall ipv4 name AZ-AVD-TO-GW default-action 'drop'
set firewall ipv4 name AZ-AVD-TO-GW rule 10 action 'accept'
set firewall ipv4 name AZ-AVD-TO-GW rule 10 state established
set firewall ipv4 name AZ-AVD-TO-GW rule 10 state related
set firewall ipv4 name AZ-AVD-TO-GW rule 20 action 'accept'
set firewall ipv4 name AZ-AVD-TO-GW rule 20 state new
set firewall ipv4 name AZ-AVD-TO-GW rule 20 protocol 'tcp'
set firewall ipv4 name AZ-AVD-TO-GW rule 20 destination group network-group 'AZ_LOCAL_GW'
set firewall ipv4 name AZ-AVD-TO-GW rule 20 destination port '443'
set firewall ipv4 name AZ-AVD-TO-GW rule 30 action 'accept'
set firewall ipv4 name AZ-AVD-TO-GW rule 30 state new
set firewall ipv4 name AZ-AVD-TO-GW rule 30 protocol 'udp'
set firewall ipv4 name AZ-AVD-TO-GW rule 30 destination group network-group 'AZ_LOCAL_GW'
set firewall ipv4 name AZ-AVD-TO-GW rule 30 destination port '443'
set firewall ipv4 name AZ-AVD-TO-GW rule 40 action 'accept'
set firewall ipv4 name AZ-AVD-TO-GW rule 40 state new
set firewall ipv4 name AZ-AVD-TO-GW rule 40 protocol 'udp'
set firewall ipv4 name AZ-AVD-TO-GW rule 40 destination group network-group 'AZ_LOCAL_GW'
set firewall ipv4 name AZ-AVD-TO-GW rule 40 destination port '53'

set firewall ipv4 name AZ-AVD-TO-SDPC default-action 'drop'
set firewall ipv4 name AZ-AVD-TO-SDPC rule 10 action 'accept'
set firewall ipv4 name AZ-AVD-TO-SDPC rule 10 state established
set firewall ipv4 name AZ-AVD-TO-SDPC rule 10 state related
set firewall ipv4 name AZ-AVD-TO-SDPC rule 20 action 'accept'
set firewall ipv4 name AZ-AVD-TO-SDPC rule 20 state new
set firewall ipv4 name AZ-AVD-TO-SDPC rule 20 protocol 'tcp'
set firewall ipv4 name AZ-AVD-TO-SDPC rule 20 destination group network-group 'AZ_LOCAL_SDPC'
set firewall ipv4 name AZ-AVD-TO-SDPC rule 20 destination port '443'
set firewall ipv4 name AZ-AVD-TO-SDPC rule 30 action 'accept'
set firewall ipv4 name AZ-AVD-TO-SDPC rule 30 state new
set firewall ipv4 name AZ-AVD-TO-SDPC rule 30 protocol 'udp'
set firewall ipv4 name AZ-AVD-TO-SDPC rule 30 destination group network-group 'AZ_LOCAL_SDPC'
set firewall ipv4 name AZ-AVD-TO-SDPC rule 30 destination port '443'
set firewall ipv4 name AZ-AVD-TO-SDPC rule 40 action 'accept'
set firewall ipv4 name AZ-AVD-TO-SDPC rule 40 state new
set firewall ipv4 name AZ-AVD-TO-SDPC rule 40 protocol 'udp'
set firewall ipv4 name AZ-AVD-TO-SDPC rule 40 destination group network-group 'AZ_LOCAL_SDPC'
set firewall ipv4 name AZ-AVD-TO-SDPC rule 40 destination port '53'

set firewall ipv4 name AZ-GW-TO-LOCAL-DOWN default-action 'drop'
set firewall ipv4 name AZ-GW-TO-LOCAL-DOWN rule 10 action 'accept'
set firewall ipv4 name AZ-GW-TO-LOCAL-DOWN rule 10 state established
set firewall ipv4 name AZ-GW-TO-LOCAL-DOWN rule 10 state related
set firewall ipv4 name AZ-GW-TO-LOCAL-DOWN rule 20 action 'accept'
set firewall ipv4 name AZ-GW-TO-LOCAL-DOWN rule 20 state new
set firewall ipv4 name AZ-GW-TO-LOCAL-DOWN rule 20 protocol 'tcp'
set firewall ipv4 name AZ-GW-TO-LOCAL-DOWN rule 20 destination group network-group 'AZ_LOCAL_DOWNSTREAM'
set firewall ipv4 name AZ-GW-TO-LOCAL-DOWN rule 20 destination group port-group 'PROTECTED_TCP'
set firewall ipv4 name AZ-GW-TO-LOCAL-DOWN rule 30 action 'accept'
set firewall ipv4 name AZ-GW-TO-LOCAL-DOWN rule 30 state new
set firewall ipv4 name AZ-GW-TO-LOCAL-DOWN rule 30 protocol 'udp'
set firewall ipv4 name AZ-GW-TO-LOCAL-DOWN rule 30 destination group network-group 'AZ_LOCAL_DOWNSTREAM'
set firewall ipv4 name AZ-GW-TO-LOCAL-DOWN rule 30 destination group port-group 'PROTECTED_UDP'

set firewall ipv4 name AZ-GW-TO-REMOTE-DOWN default-action 'drop'
set firewall ipv4 name AZ-GW-TO-REMOTE-DOWN rule 10 action 'accept'
set firewall ipv4 name AZ-GW-TO-REMOTE-DOWN rule 10 state established
set firewall ipv4 name AZ-GW-TO-REMOTE-DOWN rule 10 state related
set firewall ipv4 name AZ-GW-TO-REMOTE-DOWN rule 20 action 'accept'
set firewall ipv4 name AZ-GW-TO-REMOTE-DOWN rule 20 state new
set firewall ipv4 name AZ-GW-TO-REMOTE-DOWN rule 20 protocol 'tcp'
set firewall ipv4 name AZ-GW-TO-REMOTE-DOWN rule 20 destination group network-group 'AZ_REMOTE_DOWNSTREAM'
set firewall ipv4 name AZ-GW-TO-REMOTE-DOWN rule 20 destination group port-group 'PROTECTED_TCP'
set firewall ipv4 name AZ-GW-TO-REMOTE-DOWN rule 30 action 'accept'
set firewall ipv4 name AZ-GW-TO-REMOTE-DOWN rule 30 state new
set firewall ipv4 name AZ-GW-TO-REMOTE-DOWN rule 30 protocol 'udp'
set firewall ipv4 name AZ-GW-TO-REMOTE-DOWN rule 30 destination group network-group 'AZ_REMOTE_DOWNSTREAM'
set firewall ipv4 name AZ-GW-TO-REMOTE-DOWN rule 30 destination group port-group 'PROTECTED_UDP'

# ONP rulesets (mirror)
set firewall ipv4 name ONP-SDPC-TO-GW default-action 'drop'
set firewall ipv4 name ONP-SDPC-TO-GW rule 10 action 'accept'
set firewall ipv4 name ONP-SDPC-TO-GW rule 10 state established
set firewall ipv4 name ONP-SDPC-TO-GW rule 10 state related
set firewall ipv4 name ONP-SDPC-TO-GW rule 20 action 'accept'
set firewall ipv4 name ONP-SDPC-TO-GW rule 20 state new
set firewall ipv4 name ONP-SDPC-TO-GW rule 20 protocol 'tcp'
set firewall ipv4 name ONP-SDPC-TO-GW rule 20 destination group network-group 'ONP_LOCAL_GW'
set firewall ipv4 name ONP-SDPC-TO-GW rule 20 destination port '443'
set firewall ipv4 name ONP-SDPC-TO-GW rule 30 action 'accept'
set firewall ipv4 name ONP-SDPC-TO-GW rule 30 state new
set firewall ipv4 name ONP-SDPC-TO-GW rule 30 protocol 'tcp'
set firewall ipv4 name ONP-SDPC-TO-GW rule 30 destination group network-group 'ONP_LOCAL_GW'
set firewall ipv4 name ONP-SDPC-TO-GW rule 30 destination port '444'

set firewall ipv4 name ONP-SDPC-TO-REMOTE-GW default-action 'drop'
set firewall ipv4 name ONP-SDPC-TO-REMOTE-GW rule 10 action 'accept'
set firewall ipv4 name ONP-SDPC-TO-REMOTE-GW rule 10 state established
set firewall ipv4 name ONP-SDPC-TO-REMOTE-GW rule 10 state related
set firewall ipv4 name ONP-SDPC-TO-REMOTE-GW rule 20 action 'accept'
set firewall ipv4 name ONP-SDPC-TO-REMOTE-GW rule 20 state new
set firewall ipv4 name ONP-SDPC-TO-REMOTE-GW rule 20 protocol 'tcp'
set firewall ipv4 name ONP-SDPC-TO-REMOTE-GW rule 20 destination group network-group 'ONP_REMOTE_GW'
set firewall ipv4 name ONP-SDPC-TO-REMOTE-GW rule 20 destination port '443'
set firewall ipv4 name ONP-SDPC-TO-REMOTE-GW rule 30 action 'accept'
set firewall ipv4 name ONP-SDPC-TO-REMOTE-GW rule 30 state new
set firewall ipv4 name ONP-SDPC-TO-REMOTE-GW rule 30 protocol 'tcp'
set firewall ipv4 name ONP-SDPC-TO-REMOTE-GW rule 30 destination group network-group 'ONP_REMOTE_GW'
set firewall ipv4 name ONP-SDPC-TO-REMOTE-GW rule 30 destination port '444'

set firewall ipv4 name ONP-AVD-TO-GW default-action 'drop'
set firewall ipv4 name ONP-AVD-TO-GW rule 10 action 'accept'
set firewall ipv4 name ONP-AVD-TO-GW rule 10 state established
set firewall ipv4 name ONP-AVD-TO-GW rule 10 state related
set firewall ipv4 name ONP-AVD-TO-GW rule 20 action 'accept'
set firewall ipv4 name ONP-AVD-TO-GW rule 20 state new
set firewall ipv4 name ONP-AVD-TO-GW rule 20 protocol 'tcp'
set firewall ipv4 name ONP-AVD-TO-GW rule 20 destination group network-group 'ONP_LOCAL_GW'
set firewall ipv4 name ONP-AVD-TO-GW rule 20 destination port '443'
set firewall ipv4 name ONP-AVD-TO-GW rule 30 action 'accept'
set firewall ipv4 name ONP-AVD-TO-GW rule 30 state new
set firewall ipv4 name ONP-AVD-TO-GW rule 30 protocol 'udp'
set firewall ipv4 name ONP-AVD-TO-GW rule 30 destination group network-group 'ONP_LOCAL_GW'
set firewall ipv4 name ONP-AVD-TO-GW rule 30 destination port '443'
set firewall ipv4 name ONP-AVD-TO-GW rule 40 action 'accept'
set firewall ipv4 name ONP-AVD-TO-GW rule 40 state new
set firewall ipv4 name ONP-AVD-TO-GW rule 40 protocol 'udp'
set firewall ipv4 name ONP-AVD-TO-GW rule 40 destination group network-group 'ONP_LOCAL_GW'
set firewall ipv4 name ONP-AVD-TO-GW rule 40 destination port '53'

set firewall ipv4 name ONP-AVD-TO-SDPC default-action 'drop'
set firewall ipv4 name ONP-AVD-TO-SDPC rule 10 action 'accept'
set firewall ipv4 name ONP-AVD-TO-SDPC rule 10 state established
set firewall ipv4 name ONP-AVD-TO-SDPC rule 10 state related
set firewall ipv4 name ONP-AVD-TO-SDPC rule 20 action 'accept'
set firewall ipv4 name ONP-AVD-TO-SDPC rule 20 state new
set firewall ipv4 name ONP-AVD-TO-SDPC rule 20 protocol 'tcp'
set firewall ipv4 name ONP-AVD-TO-SDPC rule 20 destination group network-group 'ONP_LOCAL_SDPC'
set firewall ipv4 name ONP-AVD-TO-SDPC rule 20 destination port '443'
set firewall ipv4 name ONP-AVD-TO-SDPC rule 30 action 'accept'
set firewall ipv4 name ONP-AVD-TO-SDPC rule 30 state new
set firewall ipv4 name ONP-AVD-TO-SDPC rule 30 protocol 'udp'
set firewall ipv4 name ONP-AVD-TO-SDPC rule 30 destination group network-group 'ONP_LOCAL_SDPC'
set firewall ipv4 name ONP-AVD-TO-SDPC rule 30 destination port '443'
set firewall ipv4 name ONP-AVD-TO-SDPC rule 40 action 'accept'
set firewall ipv4 name ONP-AVD-TO-SDPC rule 40 state new
set firewall ipv4 name ONP-AVD-TO-SDPC rule 40 protocol 'udp'
set firewall ipv4 name ONP-AVD-TO-SDPC rule 40 destination group network-group 'ONP_LOCAL_SDPC'
set firewall ipv4 name ONP-AVD-TO-SDPC rule 40 destination port '53'

set firewall ipv4 name ONP-GW-TO-LOCAL-DOWN default-action 'drop'
set firewall ipv4 name ONP-GW-TO-LOCAL-DOWN rule 10 action 'accept'
set firewall ipv4 name ONP-GW-TO-LOCAL-DOWN rule 10 state established
set firewall ipv4 name ONP-GW-TO-LOCAL-DOWN rule 10 state related
set firewall ipv4 name ONP-GW-TO-LOCAL-DOWN rule 20 action 'accept'
set firewall ipv4 name ONP-GW-TO-LOCAL-DOWN rule 20 state new
set firewall ipv4 name ONP-GW-TO-LOCAL-DOWN rule 20 protocol 'tcp'
set firewall ipv4 name ONP-GW-TO-LOCAL-DOWN rule 20 destination group network-group 'ONP_LOCAL_DOWNSTREAM'
set firewall ipv4 name ONP-GW-TO-LOCAL-DOWN rule 20 destination group port-group 'PROTECTED_TCP'
set firewall ipv4 name ONP-GW-TO-LOCAL-DOWN rule 30 action 'accept'
set firewall ipv4 name ONP-GW-TO-LOCAL-DOWN rule 30 state new
set firewall ipv4 name ONP-GW-TO-LOCAL-DOWN rule 30 protocol 'udp'
set firewall ipv4 name ONP-GW-TO-LOCAL-DOWN rule 30 destination group network-group 'ONP_LOCAL_DOWNSTREAM'
set firewall ipv4 name ONP-GW-TO-LOCAL-DOWN rule 30 destination group port-group 'PROTECTED_UDP'

set firewall ipv4 name ONP-GW-TO-REMOTE-DOWN default-action 'drop'
set firewall ipv4 name ONP-GW-TO-REMOTE-DOWN rule 10 action 'accept'
set firewall ipv4 name ONP-GW-TO-REMOTE-DOWN rule 10 state established
set firewall ipv4 name ONP-GW-TO-REMOTE-DOWN rule 10 state related
set firewall ipv4 name ONP-GW-TO-REMOTE-DOWN rule 20 action 'accept'
set firewall ipv4 name ONP-GW-TO-REMOTE-DOWN rule 20 state new
set firewall ipv4 name ONP-GW-TO-REMOTE-DOWN rule 20 protocol 'tcp'
set firewall ipv4 name ONP-GW-TO-REMOTE-DOWN rule 20 destination group network-group 'ONP_REMOTE_DOWNSTREAM'
set firewall ipv4 name ONP-GW-TO-REMOTE-DOWN rule 20 destination group port-group 'PROTECTED_TCP'
set firewall ipv4 name ONP-GW-TO-REMOTE-DOWN rule 30 action 'accept'
set firewall ipv4 name ONP-GW-TO-REMOTE-DOWN rule 30 state new
set firewall ipv4 name ONP-GW-TO-REMOTE-DOWN rule 30 protocol 'udp'
set firewall ipv4 name ONP-GW-TO-REMOTE-DOWN rule 30 destination group network-group 'ONP_REMOTE_DOWNSTREAM'
set firewall ipv4 name ONP-GW-TO-REMOTE-DOWN rule 30 destination group port-group 'PROTECTED_UDP'

# Bind AZ zones
set firewall zone AZ_SDPC interface 'eth1'
set firewall zone AZ_SDPG interface 'eth2'
set firewall zone AZ_SDPT interface 'eth3'
set firewall zone AZ_AVD interface 'eth4'
set firewall zone AZ_DREN interface 'eth0'

set firewall zone AZ_SDPG from AZ_SDPC firewall name 'AZ-SDPC-TO-GW'
set firewall zone AZ_SDPT from AZ_SDPC firewall name 'AZ-SDPC-TO-GW'
set firewall zone AZ_DREN from AZ_SDPC firewall name 'AZ-SDPC-TO-REMOTE-GW'

set firewall zone AZ_SDPG from AZ_AVD firewall name 'AZ-AVD-TO-GW'
set firewall zone AZ_SDPT from AZ_AVD firewall name 'AZ-AVD-TO-GW'
set firewall zone AZ_SDPC from AZ_AVD firewall name 'AZ-AVD-TO-SDPC'

set firewall zone AZ_SDPC from AZ_SDPG firewall name 'AZ-GW-TO-LOCAL-DOWN'
set firewall zone AZ_SDPC from AZ_SDPT firewall name 'AZ-GW-TO-LOCAL-DOWN'
set firewall zone AZ_DREN from AZ_SDPG firewall name 'AZ-GW-TO-REMOTE-DOWN'
set firewall zone AZ_DREN from AZ_SDPT firewall name 'AZ-GW-TO-REMOTE-DOWN'

# Bind ONP zones
set firewall zone ONP_SDPC interface 'eth10'
set firewall zone ONP_SDPG interface 'eth11'
set firewall zone ONP_SDPT interface 'eth12'
set firewall zone ONP_AVD interface 'eth13'
set firewall zone ONP_DREN interface 'eth9'

set firewall zone ONP_SDPG from ONP_SDPC firewall name 'ONP-SDPC-TO-GW'
set firewall zone ONP_SDPT from ONP_SDPC firewall name 'ONP-SDPC-TO-GW'
set firewall zone ONP_DREN from ONP_SDPC firewall name 'ONP-SDPC-TO-REMOTE-GW'

set firewall zone ONP_SDPG from ONP_AVD firewall name 'ONP-AVD-TO-GW'
set firewall zone ONP_SDPT from ONP_AVD firewall name 'ONP-AVD-TO-GW'
set firewall zone ONP_SDPC from ONP_AVD firewall name 'ONP-AVD-TO-SDPC'

set firewall zone ONP_SDPC from ONP_SDPG firewall name 'ONP-GW-TO-LOCAL-DOWN'
set firewall zone ONP_SDPC from ONP_SDPT firewall name 'ONP-GW-TO-LOCAL-DOWN'
set firewall zone ONP_DREN from ONP_SDPG firewall name 'ONP-GW-TO-REMOTE-DOWN'
set firewall zone ONP_DREN from ONP_SDPT firewall name 'ONP-GW-TO-REMOTE-DOWN'

# Restrict management services to MGMT only
set firewall ipv4 name MGMT-DENY default-action 'accept'
set firewall ipv4 name MGMT-DENY rule 10 action 'drop'
set firewall ipv4 name MGMT-DENY rule 10 protocol 'tcp'
set firewall ipv4 name MGMT-DENY rule 10 destination port '22'
set firewall ipv4 name MGMT-DENY rule 20 action 'drop'
set firewall ipv4 name MGMT-DENY rule 20 protocol 'tcp'
set firewall ipv4 name MGMT-DENY rule 20 destination port '443,8443'

# Apply the mgmt-deny filter only to the data-plane interfaces
set interfaces ethernet eth1 firewall local name 'MGMT-DENY'
set interfaces ethernet eth2 firewall local name 'MGMT-DENY'
set interfaces ethernet eth3 firewall local name 'MGMT-DENY'
set interfaces ethernet eth4 firewall local name 'MGMT-DENY'
set interfaces ethernet eth5 firewall local name 'MGMT-DENY'
set interfaces ethernet eth6 firewall local name 'MGMT-DENY'
set interfaces ethernet eth7 firewall local name 'MGMT-DENY'
set interfaces ethernet eth8 firewall local name 'MGMT-DENY'
set interfaces ethernet eth9 firewall local name 'MGMT-DENY'
set interfaces ethernet eth10 firewall local name 'MGMT-DENY'
set interfaces ethernet eth11 firewall local name 'MGMT-DENY'
set interfaces ethernet eth12 firewall local name 'MGMT-DENY'
set interfaces ethernet eth13 firewall local name 'MGMT-DENY'
set interfaces ethernet eth14 firewall local name 'MGMT-DENY'
set interfaces ethernet eth15 firewall local name 'MGMT-DENY'
set interfaces ethernet eth16 firewall local name 'MGMT-DENY'
set interfaces ethernet eth17 firewall local name 'MGMT-DENY'
commit
save
exit
